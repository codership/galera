language: cpp

sudo: false

cache:
  - apt
  - ccache
compiler:
  - gcc
  - clang
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
#     https://github.com/travis-ci/travis-ci/issues/3668
#     for alternatives in container builds
    packages:
      - libboost-program-options-dev
      - libssl-dev
      - check
      - scons
      - gcc-5
      - g++-5

before_install:
  - if [ ${CC} == "gcc" ]; then
      export CC=`which gcc-5`;
      export CXX=`which g++-5`;
    fi

script:
  - ${CC} --version ; ${CXX} --version
  - MEM=$(head -n 1 /proc/meminfo); RAM=(${MEM// / }); MAX_JOBS=$(( ${RAM[1]} / 262144 )); echo Jobs\:\ $MAX_JOBS; ./scripts/build.sh -j $MAX_JOBS
